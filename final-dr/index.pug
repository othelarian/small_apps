mixin appbtn(sys, v)
  button(onclick="App.sets.other.roll('"+sys+"', '"+v[0]+"')")= v[1]
mixin svgtog(nb, fn, cid)
  .tog-selector(style!=attributes.style)
    svg(width=20 * nb, height=20)
      -
        var t = [[9, -1], [30, 0]];
        if (nb == 2) { t[0][1] = 0; t[1][1] = 1; }
        else { t.push([51, 1]); }
      each v in t
        circle.btn(
          cx=v[0], cy=10, r=5, fill='#aaa',
          onclick='App.sets.'+fn+'('+v[1]+')'
        )
      circle(id=cid, cx=((nb == 2)? 9:30), cy=10, r=8)
      if block
        block

- var fate = [[-2, 'D -2'], [-1, 'DIS'], [0, 'FATE'], [1, 'ADV'], [2, 'A +2']];
- var pbta = [['d', 'Dis'], ['n', 'PbtA'], ['a', 'Adv']];
- var recluse = [['a', 'ADV'],   ['n', 'RECLUSE'], ['d', 'DIS']];
- var tinyd6 = [['d', 'Dis'], ['n', 'Tinyd6'], ['a', 'Adv']];

- function cortexdice(){}

doctype html
html
  head(lang='en')
    title final-diceroller
    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width,initial-scale=1')
    link(rel='stylesheet', href='style.css')
    script(type='text/javascript', src='bundle.js')
  body(onload='App.init()')
    svg(xmlns='http://www.w3.org/2000/svg', style='display:none')
      defs
        path#d4(d="M14.419,1.226a3,3,0,0,0-4.838,0L0,15.236l12,8.751,12-8.751Zm6.833,13.538L13,20.783V2.693ZM11,2.692V20.783L2.748,14.764Z")
        path#d6(d="M13.543.428a2.989,2.989,0,0,0-3.086,0L1,6.1V17.9l9.457,5.674a2.991,2.991,0,0,0,3.087,0L23,17.9V6.1ZM11.485,2.143a1,1,0,0,1,1.03,0l7.541,4.525L12,11.5,3.944,6.668ZM3,16.766V8.434l8,4.8v8.332Zm10,4.8V13.234l8-4.8v8.332Z")
        path#d8(d="M14.109.867A3.034,3.034,0,0,0,9.846.915L.025,12,9.891,23.133A2.977,2.977,0,0,0,12,24a3.008,3.008,0,0,0,2.155-.916L23.96,12Zm6.629,10.509L13,13.662V2.628ZM11,2.624V13.662L3.253,11.373ZM4.25,13.753,11,15.747v5.626ZM13,21.375V15.747l6.736-1.99Z")
        path#d10(d="M14.116.867A3.071,3.071,0,0,0,9.9.867L.03,13.063,9.9,23.133a3,3,0,0,0,4.23-.012L23.97,13.063ZM12.007,13.75,9.194,11.645l2.812-7.718,2.8,7.719ZM7.26,11.109,3.7,11.7,9.785,4.179Zm9.481,0L14.224,4.175,20.3,11.7ZM3.514,13.761l4.229-.7L11.008,15.5v5.907Zm9.494,7.646V15.5l3.25-2.442,4.23.705Z")
        path#d12(d="M20.729,3.271,15.277,0H8.723L3.271,3.271,0,8.723v6.554l3.271,5.452L8.723,24h6.554l5.452-3.271L24,15.277V8.723ZM21.777,8.9l-4.039,4.846L13,11.382v-4.6l6.524-1.632ZM14.307,22H9.693l-2.44-6.508L12,13.118l4.748,2.374ZM9.277,2h5.446l2.693,1.615L12,4.969,6.584,3.616Zm-4.8,3.149L11,6.78v4.6L6.262,13.751,2.223,8.9ZM2,14.723v-2.96l3.123,3.748,1.934,5.157-2.328-1.4Zm17.271,4.548-2.329,1.4,1.933-5.156L22,11.763v2.96Z")
        path#d20(d="M13.543.428a2.994,2.994,0,0,0-3.086,0L1,6.1V17.9l9.457,5.674a2.989,2.989,0,0,0,3.086,0L23,17.9V6.1ZM8.805,11H15.2L12,16.113Zm3.246-7.849L15.3,9H8.721Zm5.182,5.21-2.822-5.08,5.645,3.387ZM6.781,8.37l-2.837-1.7L9.722,3.2ZM5.738,10.076,3,14.091V8.434Zm1.224,1.75L10.007,16.7l-5.989-.552Zm10.087-.018,3.027,4.336L14,16.683Zm1.221-1.736L21,8.434v5.543ZM5.552,18.3,11,18.8v2.767ZM13,21.566V18.779l5.449-.483Z")
    #diceroller.cols
      .core
        select#the-selector(onchange='App.select()')
          option(value='classic', selected) Classic set
          option(value='other1') Recluse, Fate, Tinyd6, ZC sets
          option(value='other2') PbtA, D&amp;G sets
          option(value='other3') Cortex set
        #classic-set.set
          .dice
            each v in [4, 6, 8, 10, 12, 20]
              button(onclick='App.sets.classic.roll('+v+')')
                svg(viewbox="0 0 24 24"): use(href="#d"+v)
          .dice
            button(style='width:54px;', onclick='App.sets.classic.roll(100)')
              svg(style='width:40px', viewbox='0 0 48 24')
                use(href='#d10')
                g(transform='translate(24,0)'): use(href='#d10')
          .special
            span Special :
            input#classic-special(type='number', value=42, min=2)
            button(onclick="App.sets.classic.roll('s')") Roll
            span &nbsp;|&nbsp; Dis&nbsp;
            +svgtog(3, 'classic.advdis', 'classic-advdis')
            span &nbsp;Adv
        #other1-set.other.set
          div
            each v in recluse
              +appbtn('recluse', v)
          div
            each v in fate
              +appbtn('fate', v)
          .special
            each v in tinyd6
              +appbtn('tinyd6', v)
            span &nbsp;|&nbsp;
            +svgtog(2, 'other.tinyd6.disadv', 'other1-tinyad')
            span &nbsp;Focus
          .zc
            span ZC:&nbsp;
            div
              each v in [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
                button(onclick="App.sets.other.roll('zc', "+v+")")= v
                if v == 6
                  br
        #other2-set.other.set
          div
            each v in pbta
              +appbtn('pbta', v)
          #dag
            div(style='grid-row:1 / 3') D&amp;G:
            div(style='grid-row:1 / 3') &nbsp;|&nbsp;
            div(style='grid-column:3') Comp. :
            div(style='grid-column:3') Circ. :
            +svgtog(3, 'other.dag.comp', 'other2-dagcomp'
            )(style='grid-column:4;grid-row:1')
              text#other2-dagcomp-text(x=30, y=14) 8
            +svgtog(3, 'other.dag.circ', 'other2-dagcirc'
            )(style='grid-column:4')
              text#other2-dagcirc-text(x=30, y=14) 8
            div(style='grid-column:5;grid-row:1 / 3') &nbsp;|&nbsp;
            div(style='grid-column:6;grid-row:1') Inspiration:
            +svgtog(2, 'other.dag.focus', 'other2-dagfocus'
            )(style='grid-column:7;grid-row:1')
            div(style='grid-column:6 / 8;grid-row:2')
              button(onclick="App.sets.other.roll('dag')") Roll
        #other3-set.other.set
          #cortex
            each v in [4, 6, 8, 10, 12]
              button(onclick='App.sets.cortex.dice('+v+')')
                svg(viewbox='0 0 24 24'): use(href='#d'+v)
            div What you want to roll?
            #cortex-tray
            hr
            div
              button#cortex-clear(
                style='width:50px'
                onclick='App.sets.cortex.clear()'
              ) Clear
              button#cortex-roll(onclick='App.sets.cortex.roll()') Roll
      .result
        .res-lab Result:
        #res-show
      .flip
        button(onclick='App.flip()') See past rolls
    #history.cols
      .flip
        button(onclick='App.flip()') Back to dice
      .title Past rolls:
      #results